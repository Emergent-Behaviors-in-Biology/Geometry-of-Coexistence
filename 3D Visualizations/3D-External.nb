(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54749,       1348]
NotebookOptionsPosition[     52638,       1303]
NotebookOutlinePosition[     53077,       1320]
CellTagsIndexPosition[     53034,       1317]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeedRandom", "[", "\"\<Tabby\>\"", "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"My", " ", "cat", " ", "is", " ", "named", " ", "Tabitha"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Abs", "@", 
    RowBox[{"RandomVariate", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], ",", "20"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1.", ",", 
     RowBox[{"Length", "[", "c", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1.", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"c", "\[Transpose]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.867772139201624*^9, 3.8677722017180157`*^9}, {
   3.867773017870172*^9, 3.86777303367295*^9}, {3.8679201339587927`*^9, 
   3.867920137057321*^9}, {3.8679214974282312`*^9, 3.8679215005258503`*^9}, {
   3.867921665640057*^9, 3.867921667880168*^9}, 3.8679220014114656`*^9, 
   3.8679222426747713`*^9, {3.867922987598968*^9, 3.86792301827632*^9}, 
   3.8679242043101063`*^9, {3.867924241850781*^9, 3.867924260242898*^9}, {
   3.8679258259885597`*^9, 3.867925848403113*^9}, 3.8679262200140257`*^9, {
   3.867926297715021*^9, 3.8679263079224567`*^9}, {3.8679293798142147`*^9, 
   3.8679293808802156`*^9}, {3.867945127419593*^9, 3.8679451352260237`*^9}, {
   3.867945404059822*^9, 3.867945410697983*^9}, {3.8737615707481728`*^9, 
   3.873761571074575*^9}, {3.873761658079154*^9, 3.87376166337287*^9}, {
   3.882062049829493*^9, 3.8820620646889772`*^9}, {3.882062160041744*^9, 
   3.882062160438694*^9}, {3.8821318655764*^9, 3.882131904314398*^9}, {
   3.882136609486601*^9, 3.882136609652666*^9}, {3.8823815089280243`*^9, 
   3.882381514755416*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"a1c5103a-0cbb-422c-b79b-491500daf9d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addPCH", "[", "c_", "]"}], ":=", 
  RowBox[{"c", "\[Union]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], "}"}], "\[Union]", 
   RowBox[{"Union", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Y", "|->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"X", "|->", 
              RowBox[{"Insert", "[", 
               RowBox[{"X", ",", "0.", ",", "Y"}], "]"}]}], ")"}], "/@", 
            RowBox[{"(", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"MeshCoordinates", "@", 
                RowBox[{"ConvexHullRegion", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], "}"}], "\[Union]", "#", 
                  "\[Union]", 
                  RowBox[{"(", 
                   RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "|->", 
                    RowBox[{"Last", "@", 
                    RowBox[{"Last", "@", 
                    RowBox[{"Last", "@", 
                    RowBox[{"ConvexHullRegion", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"#1", "\[Transpose]"}], ",", "i"}], "]"}], 
                    "\[Transpose]"}], "\[Union]", 
                    RowBox[{"{", 
                    RowBox[{"{", "0", "}"}], "}"}]}], "]"}]}]}]}]}], ")"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ")"}]}], "]"}]}],
                ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "0."}], "}"}], "}"}]}], "]"}], ")"}]}], 
           "&"}], "[", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "c", ")"}], "\[Transpose]"}], ",", "Y"}], "]"}], 
           "\[Transpose]"}], "]"}], ")"}]}], ")"}], "/@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8821361986634483`*^9, 3.882136313349176*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c5236e8f-6062-41f8-acb3-55545bb664ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IFR3D", "[", 
   RowBox[{"c_", ",", "m_", ",", "w_"}], "]"}], ":=", 
  RowBox[{"RegionIntersection", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"BoundaryDiscretizeRegion", "[", 
      RowBox[{
       RowBox[{"RegionIntersection", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"HalfSpace", "[", 
           RowBox[{"#", ",", "1"}], "]"}], ",", 
          RowBox[{"HalfSpace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", "0"}], 
           "]"}], ",", 
          RowBox[{"HalfSpace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0"}], "]"}], ",", 
          RowBox[{"HalfSpace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", "0"}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"MaxCellMeasure", "->", "\[Infinity]"}]}], "]"}], "&"}], "/@", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"#", " ", "w"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"c", "/", "m"}], ")"}]}], ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882132563890175*^9, 3.882132569905321*^9}, 
   3.8821326734366693`*^9, {3.882132737525104*^9, 3.882132777947227*^9}, {
   3.8821377147520857`*^9, 3.882137745462008*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"9638338c-02cc-4314-85d6-05c0ed4be3be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExternalCRM", "[", 
   RowBox[{"\[Kappa]_", ",", "c_", ",", "m_", ",", "w_"}], "]"}], " ", ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Rs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["R", "\[Alpha]"], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Kappa]", "]"}]}], "}"}]}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{"ConvexOptimization", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"w", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Kappa]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", "\[Kappa]", "]"}], " ", "-", 
              RowBox[{"Log", "[", "Rs", "]"}]}], ")"}]}], "-", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]", "-", "Rs"}], ")"}]}], ")"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"c", ".", 
           RowBox[{"(", 
            RowBox[{"w", " ", "Rs"}], ")"}]}], "<=", "m"}], "]"}], "]"}], ",",
        "Rs", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<PrimalMinimizer\>\"", ",", "\"\<DualMaximizer\>\""}], 
        "}"}], ",", 
       RowBox[{"Tolerance", "\[Rule]", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], ",", 
       RowBox[{"MaxIterations", "->", "5000"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"Length", "[", "m", "]"}]}], "]"}], "]"}]}], "}"}], 
    "&"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8821403512465897`*^9, 3.882140353567441*^9}, {
  3.8821416538204813`*^9, 3.882141665994631*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"26bc5214-19df-4864-8e32-1b39b0386d1e"],

Cell["Slide and drag the parameters!", "Text",
 CellChangeTimes->{{3.8894483059203253`*^9, 
  3.889448310596478*^9}},ExpressionUUID->"50b88cc9-ac2c-4480-b024-\
cd939da4cb6e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Row", "/@", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", "=", "i"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"\"\<m\>\"", ",", "i"}], "]"}], ",", 
             RowBox[{"Slider", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"m", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "3"}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", "=", "\[Alpha]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"\"\<w\>\"", ",", "i"}], "]"}], ",", 
             RowBox[{"Slider", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "3"}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}],
     ",", "4", ",", "4", ",", "1", ",", "\"\<\>\""}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.880332374513571*^9, 3.880332399941523*^9}, {
  3.880406472323984*^9, 3.880406608150353*^9}, {3.880406656855063*^9, 
  3.880406673200322*^9}, {3.880406785737278*^9, 3.880406787757764*^9}, {
  3.882021114313652*^9, 3.882021145882761*^9}, {3.882136506458495*^9, 
  3.882136513169031*^9}, {3.8821369097447987`*^9, 3.882137000582959*^9}, {
  3.882137054919923*^9, 3.8821370681433687`*^9}, {3.8821371193815947`*^9, 
  3.882137136014489*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"17fbc8f7-6e00-4711-a9a8-78d2d29740d2"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
       SubscriptBox["\"m\"", "1"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 1]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "2"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 2]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "3"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 3]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "4"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 4]], {0.1, 3}]},
      "RowDefault"]},
    {
     TemplateBox[{
       SubscriptBox["\"m\"", "5"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 5]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "6"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 6]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "7"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 7]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "8"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 8]], {0.1, 3}]},
      "RowDefault"]},
    {
     TemplateBox[{
       SubscriptBox["\"m\"", "9"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 9]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "10"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 10]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "11"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 11]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "12"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 12]], {0.1, 3}]},
      "RowDefault"]},
    {
     TemplateBox[{
       SubscriptBox["\"m\"", "13"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 13]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "14"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 14]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "15"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 15]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "16"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 16]], {0.1, 3}]},
      "RowDefault"]},
    {
     TemplateBox[{
       SubscriptBox["\"m\"", "17"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 17]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "18"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 18]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "19"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 19]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"m\"", "20"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`m, 20]], {0.1, 3}]},
      "RowDefault"]},
    {
     TemplateBox[{
       SubscriptBox["\"w\"", "1"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`w, 1]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"w\"", "2"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`w, 2]], {0.1, 3}]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["\"w\"", "3"], 
       SliderBox[
        Dynamic[
         Part[$CellContext`w, 3]], {0.1, 3}]},
      "RowDefault"], "\<\"\"\>"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.882136513495376*^9, 3.882136519682889*^9}, {
   3.8821369369415216`*^9, 3.882137000918375*^9}, {3.882137064228739*^9, 
   3.882137068472637*^9}, {3.882137123467564*^9, 3.882137136415923*^9}, 
   3.882138064069448*^9, 3.882139212890478*^9, 3.882141671082363*^9, 
   3.882142892445519*^9, 3.882286473497616*^9, 3.88237756834114*^9, 
   3.8823816182520657`*^9, 3.8823820227577972`*^9, 3.8894482850177917`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"213e4d20-8da4-4e0c-a3c8-f19b62fc84b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "@", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cPCH", "=", 
      RowBox[{"addPCH", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"w", " ", "#"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"c", "/", "m"}], ")"}]}], ")"}], "]"}]}], "}"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FaceForm", "[", 
         RowBox[{"RGBColor", "[", 
          RowBox[{
           FractionBox["4", "255"], ",", 
           FractionBox["41", "255"], ",", 
           FractionBox["64", "255"], ",", "0.1"}], "]"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Opacity", "[", "0.2", "]"}], "]"}], ",", 
        RowBox[{"ConvexHullMesh", "[", "cPCH", "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          FractionBox["0", "255"], ",", 
          FractionBox["92", "255"], ",", 
          FractionBox["83", "255"]}], "]"}], ",", 
        RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
        RowBox[{"Point", "[", "cPCH", "]"}]}], "}"}], ",", 
      RowBox[{"Axes", "->", "True"}], ",", 
      RowBox[{"Ticks", "->", "Automatic"}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|"boxes" -> FormBox[
             SubscriptBox[
              RowBox[{"(", 
                SubscriptBox[
                 StyleBox["C", FontSlant -> "Bold"], 
                 StyleBox["i", "TI"]], ")"}], "1"], TraditionalForm], 
           "errors" -> {}, "input" -> "\\left(\\mathbf C_i\\right)_1", 
           "state" -> "Boxes"|>,
          "TeXAssistantTemplate"], ",", 
         TemplateBox[<|"boxes" -> FormBox[
             SubscriptBox[
              RowBox[{"(", 
                SubscriptBox[
                 StyleBox["C", FontSlant -> "Bold"], 
                 StyleBox["i", "TI"]], ")"}], "2"], TraditionalForm], 
           "errors" -> {}, "input" -> "\\left(\\mathbf C_i\\right)_2", 
           "state" -> "Boxes"|>,
          "TeXAssistantTemplate"], ",", 
         TemplateBox[<|"boxes" -> FormBox[
             SubscriptBox[
              RowBox[{"(", 
                SubscriptBox[
                 StyleBox["C", FontSlant -> "Bold"], 
                 StyleBox["i", "TI"]], ")"}], "3"], TraditionalForm], 
           "errors" -> {}, "input" -> "\\left(\\mathbf C_i\\right)_3", 
           "state" -> "Boxes"|>,
          "TeXAssistantTemplate"]}], "}"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882132895731649*^9, 3.882132929375627*^9}, {
   3.88213297203407*^9, 3.882133012645069*^9}, {3.8821356501421347`*^9, 
   3.882135650599099*^9}, {3.882136054081081*^9, 3.8821360605022306`*^9}, {
   3.882136113406519*^9, 3.882136115737142*^9}, {3.882136329317428*^9, 
   3.882136332215365*^9}, {3.882136362234811*^9, 3.8821363754109898`*^9}, {
   3.882136534176059*^9, 3.882136535011153*^9}, 3.882381535912435*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"0f74b515-51c4-4425-8b92-146bfeec38c8"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   With[{$CellContext`cPCH = $CellContext`addPCH[
       Map[$CellContext`w #& , $CellContext`c/$CellContext`m]]}, 
    Graphics3D[{
      FaceForm[
       RGBColor[4/255, 41/255, 64/255, 0.1]], 
      EdgeForm[
       Opacity[0.2]], 
      ConvexHullMesh[$CellContext`cPCH], 
      RGBColor[0/255, 92/255, 83/255], 
      PointSize[Medium], 
      Point[$CellContext`cPCH]}, Axes -> True, Ticks -> Automatic, AxesLabel -> {
       Subscript[
        Subscript[C, $CellContext`i], 1], 
       Subscript[
        Subscript[C, $CellContext`i], 2], 
       Subscript[
        Subscript[C, $CellContext`i], 3]}]], StandardForm],
  ImageSizeCache->{360., {185., 189.}}]], "Output",
 CellChangeTimes->{{3.882132897180729*^9, 3.882132915423328*^9}, {
   3.882132973067428*^9, 3.88213301308181*^9}, {3.882135622959405*^9, 
   3.8821356510099993`*^9}, 3.882135728873168*^9, {3.882136056516695*^9, 
   3.882136116173108*^9}, {3.882136238313774*^9, 3.882136284208345*^9}, 
   3.8821363760494833`*^9, 3.882136535308107*^9, 3.882138064839613*^9, 
   3.882139213893609*^9, 3.882141678327662*^9, 3.8821428932092733`*^9, 
   3.8822864742098007`*^9, 3.8823775753816137`*^9, 3.882381618261902*^9, 
   3.882382023060638*^9, {3.889448285336193*^9, 3.889448302608357*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"867a9d76-c977-4461-982f-740ebc62c519"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RR3D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["R", "\[Alpha]"], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"c", "\[Transpose]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN3D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["n", "i"], "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR03D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["R0", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"c", "\[Transpose]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN03D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["N0", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "c", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KK3D", "=", 
   RowBox[{"{", 
    RowBox[{"K1", ",", "K2", ",", "K3"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8686242726272078`*^9, 3.868624280101191*^9}, 
   3.869331527038226*^9, {3.880331972150976*^9, 3.880331974275766*^9}, {
   3.882137375993794*^9, 3.882137376653566*^9}, {3.882137502990999*^9, 
   3.882137512353134*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"a2b65e1c-ad4a-4ad2-ab09-56c171d39568"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExternalCRMdiffEqs3D", "[", 
   RowBox[{"c_", ",", "m_", ",", "w_"}], "]"}], ":=", 
  RowBox[{"ParametricNDSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"NN3D", ",", "t"}], "]"}], "==", 
        RowBox[{"NN3D", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", ".", 
            RowBox[{"(", 
             RowBox[{"w", " ", "RR3D"}], ")"}]}], "-", "m"}], ")"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"RR3D", ",", "t"}], "]"}], "==", 
        RowBox[{"KK3D", "-", "RR3D", "-", 
         RowBox[{"RR3D", 
          RowBox[{"(", 
           RowBox[{"NN3D", ".", "c"}], ")"}]}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NN3D", "/.", 
          RowBox[{"t", "->", "0"}]}], ")"}], "==", "NN03D"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"RR3D", "/.", 
          RowBox[{"t", "->", "0"}]}], ")"}], "==", "RR03D"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"Head", "/@", 
     RowBox[{"(", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"RR3D", ",", "NN3D"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "100"}], "}"}], ",", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"KK3D", ",", "RR03D", ",", "NN03D"}], "}"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<TimeIntegration\>\"", "\[Rule]", "\"\<ExplicitRungeKutta\>\""}], 
       "}"}]}]}], "*)"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8821426667815943`*^9, 3.88214268113461*^9}, {
  3.8821495703711033`*^9, 3.882149570623005*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"0d6d2d2a-0237-4165-a26f-6429203d2313"],

Cell["\<\
If you change any parameters, be sure to re-evaluate the cell below. This was \
not made dynamic because it slowed simulations.\
\>", "Text",
 CellChangeTimes->{{3.8823811422502737`*^9, 
  3.8823811736248913`*^9}},ExpressionUUID->"f6643f13-98e4-4ab0-9760-\
b30ac15465f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ifr", "=", 
   RowBox[{"IFR3D", "[", 
    RowBox[{"c", ",", "m", ",", "w"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cPCH", "=", 
   RowBox[{"addPCH", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"w", " ", "#"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"c", "/", "m"}], ")"}]}], ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch", "=", 
   RowBox[{"ConvexHullRegion", "[", "cPCH", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882138159983588*^9, 3.88213822696739*^9}, {
  3.882143395059589*^9, 3.882143396457844*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"1a8c8e36-a3e3-407f-a20d-f67e8363a34d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"aa", "=", "200"}], ",", 
     RowBox[{"vp", "=", 
      RowBox[{"{", 
       RowBox[{"200", ",", "80", ",", "80"}], "}"}]}], ",", 
     RowBox[{"vv", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Dynamic", "@", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"CRMResults", "=", 
             RowBox[{"ExternalCRM", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", "c", ",", 
               "m", ",", "w"}], "]"}]}], "}"}], ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"survSpecies", "=", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{"#", ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "6"}]]}], "]"}], "&"}], "@", 
                   RowBox[{"CRMResults", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{"_", "?", "Positive"}]}], "]"}]}]}], "}"}], ",", 
             RowBox[{"Row", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Show", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.5", ",", "0.5", ",", "0.9"}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"{", 
                    RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{
                    RowBox[{"159", "/", "255"}], ",", 
                    RowBox[{"193", "/", "255"}], ",", 
                    RowBox[{"49", "/", "255"}], ",", "0.4"}], "]"}], ",", 
                    RowBox[{"ConicHullRegion", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"CRMResults", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "6"}]]}], "]"}], "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", " ", 
                    RowBox[{"CRMResults", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "survSpecies", "]"}], "]"}], ")"}]}], 
                    ")"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"ClipPlanes", "->", 
                    RowBox[{"InfinitePlane", "[", 
                    RowBox[{"4", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
                    "]"}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"PlotRange", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}]}], "*)"}], ",", 
                    
                    RowBox[{"PlotRange", "->", 
                    RowBox[{"2", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"RegionPlot3D", "[", 
                    RowBox[{"ifr", ",", 
                    RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{
                    RowBox[{"214", "/", "255"}], ",", 
                    RowBox[{"213", "/", "255"}], ",", 
                    RowBox[{"142", "/", "255"}], ",", "1"}], "]"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"2", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"ViewPoint", "->", 
                    RowBox[{"Dynamic", "@", "vp"}]}], ",", 
                   RowBox[{"ViewVertical", "->", 
                    RowBox[{"Dynamic", "@", "vv"}]}], ",", 
                   RowBox[{"ViewCenter", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "->", "500"}], ",", 
                   RowBox[{"Axes", "->", "True"}], ",", 
                   RowBox[{"AxesLabel", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*StyleBox[SubscriptBox[\"R\", \
StyleBox[\"1\",FontSize->13,FontSlant->\"Plain\"]],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)\>\"", ",", 
                    "\"\<\!\(\*StyleBox[SubscriptBox[\"R\", \
StyleBox[\"2\",FontSize->13,FontSlant->\"Plain\"]],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)\>\"", ",", 
                    "\"\<\!\(\*StyleBox[SubscriptBox[\"R\", \
StyleBox[\"3\",FontSize->13,FontSlant->\"Plain\"]],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)\>\""}], "}"}]}], ",", 
                   RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], 
                   ",", 
                   RowBox[{"Ticks", "->", "Automatic"}], ",", 
                   RowBox[{"Boxed", "->", "False"}], ",", 
                   RowBox[{"AxesOrigin", "->", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{"Lighting", "\[Rule]", 
                    RowBox[{"AmbientLight", "[", "White", "]"}]}], ",", 
                   RowBox[{"ViewProjection", "->", "\"\<Orthographic\>\""}]}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Show", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{
                    FractionBox["4", "255"], ",", 
                    FractionBox["41", "255"], ",", 
                    FractionBox["64", "255"], ",", "0.1"}], "]"}], "]"}], ",", 
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"Opacity", "[", "0.2", "]"}], "]"}], ",", "ch", 
                    ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{
                    FractionBox["0", "255"], ",", 
                    FractionBox["92", "255"], ",", 
                    FractionBox["83", "255"]}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
                    RowBox[{"Point", "[", "cPCH", "]"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{
                    FractionBox["159", "255"], ",", 
                    FractionBox["193", "255"], ",", 
                    FractionBox["49", "255"]}], "]"}], ",", 
                    RowBox[{"PointSize", "[", "0.05`", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "w"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"c", "/", "m"}], ")"}]}], ")"}], "[", 
                    RowBox[{"[", "survSpecies", "]"}], "]"}], "]"}]}], "}"}], 
                    "]"}], "}"}], ",", 
                   RowBox[{"ImageSize", "->", "500"}], ",", 
                   RowBox[{"Axes", "->", "True"}], ",", 
                   RowBox[{"AxesLabel", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*StyleBox[TemplateBox[<|\"boxes\" -> FormBox[
SubscriptBox[
RowBox[{\"(\", 
SubscriptBox[
StyleBox[\"C\", FontSlant -> \"Bold\"], 
StyleBox[\"i\", \"TI\"]], \")\"}], \"1\"], TraditionalForm], \"errors\" -> \
{}, \"input\" -> \"\\\\left(\\\\mathbf C_i\\\\right)_1\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Bold\"]\)\>\"", ",", 
                    "\"\<\!\(\*StyleBox[TemplateBox[<|\"boxes\" -> FormBox[
SubscriptBox[
RowBox[{\"(\", 
SubscriptBox[
StyleBox[\"C\", FontSlant -> \"Bold\"], 
StyleBox[\"i\", \"TI\"]], \")\"}], \"2\"], TraditionalForm], \"errors\" -> \
{}, \"input\" -> \"\\\\left(\\\\mathbf C_i\\\\right)_2\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Bold\"]\)\>\"", ",", 
                    "\"\<\!\(\*StyleBox[TemplateBox[<|\"boxes\" -> FormBox[
SubscriptBox[
RowBox[{\"(\", 
SubscriptBox[
StyleBox[\"C\", FontSlant -> \"Bold\"], 
StyleBox[\"i\", \"TI\"]], \")\"}], \"3\"], TraditionalForm], \"errors\" -> \
{}, \"input\" -> \"\\\\left(\\\\mathbf C_i\\\\right)_3\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Bold\"]\)\>\""}], "}"}]}], ",", 
                   RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], 
                   ",", 
                   RowBox[{"Ticks", "->", "None"}], ",", 
                   RowBox[{"Boxed", "->", "False"}], ",", 
                   RowBox[{"AxesOrigin", "->", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", 
                   RowBox[{"ViewPoint", "->", 
                    RowBox[{"Dynamic", "@", "vp"}]}], ",", 
                   RowBox[{"ViewVertical", "->", 
                    RowBox[{"Dynamic", "@", "vv"}]}], ",", 
                   RowBox[{"ViewCenter", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], ",", 
                   RowBox[{"ViewProjection", "->", "\"\<Orthographic\>\""}]}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               RowBox[{"ImageSize", "->", "1000"}]}], "]"}]}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Dynamic", "@", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#", "@@", 
                   RowBox[{"(", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", 
                    RowBox[{"ConstantArray", "[", " ", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "2"}]], ",", 
                    RowBox[{"Length", "[", "c", "]"}]}], "]"}]}], "]"}], 
                    ")"}]}], "/.", 
                  RowBox[{"ExternalCRMdiffEqs3D", "[", 
                   RowBox[{"c", ",", "m", ",", "w"}], "]"}]}], ")"}], "[", 
                "t", "]"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Head", "/@", "NN3D"}], ")"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "100"}], "}"}], ",", 
           RowBox[{"AspectRatio", "->", 
            RowBox[{"1", "/", "3"}]}], ",", 
           RowBox[{"ImageSize", "->", "400"}], ",", 
           RowBox[{"Ticks", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "All"}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"#", ",", "Thick"}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{
                
                TemplateBox[<|
                 "color" -> 
                  RGBColor[
                   0.9764705882352941, 0.6274509803921569, 
                    0.24705882352941178`]|>,
                 "RGBColorSwatchTemplate"], ",", 
                
                TemplateBox[<|
                 "color" -> 
                  RGBColor[
                   0.4470588235294118, 0.6627450980392157, 
                    0.5607843137254902]|>,
                 "RGBColorSwatchTemplate"], ",", 
                
                TemplateBox[<|
                 "color" -> 
                  RGBColor[0.6196078431372549, 0.35000000000000003`, 0.78]|>,
                 "RGBColorSwatchTemplate"], ",", 
                
                TemplateBox[<|
                 "color" -> 
                  RGBColor[0., 0.4117647058823529, 0.5372549019607843]|>,
                 "RGBColorSwatchTemplate"], ",", 
                
                TemplateBox[<|
                 "color" -> 
                  RGBColor[
                   0.8470588235294118, 0.06666666666666667, 
                    0.34901960784313724`]|>,
                 "RGBColorSwatchTemplate"]}], "}"}]}], ")"}]}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*StyleBox[\"t\",FontFamily->\"CMU \
Serif\",FontSize->14,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)\>\"", ",", 
              "\"\<\!\(\*StyleBox[SubscriptBox[\"N\", \
\"i\"],FontFamily->\"CMU \
Serif\",FontSize->14,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)\>\""}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
       "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", ",", "0.644"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", ",", "1.49"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k3", ",", "0.643"}], "}"}], ",", "0", ",", "2"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882137818089717*^9, 3.882137890492634*^9}, {
   3.882137921529315*^9, 3.8821379686980953`*^9}, {3.8821380005139236`*^9, 
   3.8821380372009773`*^9}, 3.882138084642025*^9, {3.88213815819903*^9, 
   3.882138162932021*^9}, {3.882138223063775*^9, 3.882138223438686*^9}, {
   3.882138293205097*^9, 3.882138332326851*^9}, {3.8821383713008413`*^9, 
   3.882138400965788*^9}, {3.882138681259872*^9, 3.8821386834640913`*^9}, {
   3.882138743405458*^9, 3.8821387663453913`*^9}, {3.882138819449061*^9, 
   3.882138862051714*^9}, {3.882138929818356*^9, 3.88213898285911*^9}, {
   3.8821390933344517`*^9, 3.88213910316816*^9}, {3.8821392946364393`*^9, 
   3.8821393219131393`*^9}, {3.8821417665856733`*^9, 3.882141791296297*^9}, {
   3.882142205305847*^9, 3.882142225673176*^9}, {3.8821422696176577`*^9, 
   3.882142299249353*^9}, {3.882143193655663*^9, 3.882143193921248*^9}, {
   3.882143392366146*^9, 3.882143394020192*^9}, {3.882149515690344*^9, 
   3.882149515771513*^9}, {3.882149575975749*^9, 3.882149576208518*^9}, {
   3.8823815571109867`*^9, 3.882381611821954*^9}, {3.882381678909032*^9, 
   3.882381682564052*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"31f24bdc-de3d-42c9-ba9e-91aa2fa73037"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`aa$$ = 200, $CellContext`vp$$ = {200, 80, 
  80}, $CellContext`vv$$ = {0, 0, 1}}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{$CellContext`k1$$ = 0.644, $CellContext`k2$$ = 
     1.49, $CellContext`k3$$ = 0.643, Typeset`show$$ = True, 
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
     Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
     "\"untitled\"", Typeset`specs$$ = {{{
        Hold[$CellContext`k1$$], 0.644}, 0, 2}, {{
        Hold[$CellContext`k2$$], 1.49}, 0, 2}, {{
        Hold[$CellContext`k3$$], 0.643}, 0, 2}}, Typeset`size$$ = {
     1000., {328.134033203125, 333.865966796875}}, Typeset`update$$ = 0, 
     Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, 
       "Variables" :> {$CellContext`k1$$ = 0.644, $CellContext`k2$$ = 
         1.49, $CellContext`k3$$ = 0.643}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Column[{
          Dynamic[
           
           Block[{$CellContext`CRMResults = \
$CellContext`ExternalCRM[{$CellContext`k1$$, $CellContext`k2$$, \
$CellContext`k3$$}, $CellContext`c, $CellContext`m, $CellContext`w]}, 
            Block[{$CellContext`survSpecies = Flatten[
                Position[
                 (Chop[#, 10^(-6)]& )[
                  Part[$CellContext`CRMResults, 2]], 
                 PatternTest[
                  Blank[], Positive]]]}, 
             Row[{
               Show[{
                 Graphics3D[{
                   RGBColor[0.5, 0.5, 0.9], 
                   PointSize[0.03], 
                   Point[
                    
                    Dynamic[{$CellContext`k1$$, $CellContext`k2$$, \
$CellContext`k3$$}]], 
                   RGBColor[159/255, 193/255, 49/255, 0.4], 
                   ConicHullRegion[{
                    Chop[
                    Part[$CellContext`CRMResults, 1], 10^(-6)]}, 
                    Map[# Part[$CellContext`CRMResults, 1]& , 
                    Part[$CellContext`c, $CellContext`survSpecies]]]}, 
                  ClipPlanes -> 
                  InfinitePlane[4 {{0, 0, 1}, {0, 1, 0}, {1, 0, 0}}], 
                  PlotRange -> 2 {{0, 1}, {0, 1}, {0, 1}}], 
                 
                 RegionPlot3D[$CellContext`ifr, Mesh -> None, PlotStyle -> 
                  RGBColor[214/255, 213/255, 142/255, 1], PlotRange -> 
                  2 {{0, 1}, {0, 1}, {0, 1}}]}, ViewPoint -> 
                Dynamic[$CellContext`vp$$], ViewVertical -> 
                Dynamic[$CellContext`vv$$], ViewCenter -> {1/2, 1/2, 1/2}, 
                ImageSize -> 500, Axes -> True, 
                AxesLabel -> {
                 "\!\(\*StyleBox[SubscriptBox[\"R\", \
StyleBox[\"1\",FontSize->13,FontSlant->\"Plain\"]],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)", 
                  "\!\(\*StyleBox[SubscriptBox[\"R\", \
StyleBox[\"2\",FontSize->13,FontSlant->\"Plain\"]],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)", 
                  "\!\(\*StyleBox[SubscriptBox[\"R\", \
StyleBox[\"3\",FontSize->13,FontSlant->\"Plain\"]],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)"}, PlotTheme -> "Scientific", Ticks -> Automatic, 
                Boxed -> False, AxesOrigin -> {0, 0, 0}, Lighting -> 
                AmbientLight[White], ViewProjection -> "Orthographic"], 
               Show[{
                 Graphics3D[{
                   FaceForm[
                    RGBColor[4/255, 41/255, 64/255, 0.1]], 
                   EdgeForm[
                    Opacity[0.2]], $CellContext`ch, 
                   RGBColor[0/255, 92/255, 83/255], 
                   PointSize[Medium], 
                   Point[$CellContext`cPCH], 
                   RGBColor[159/255, 193/255, 49/255], 
                   PointSize[0.05], 
                   Point[
                    Part[
                    
                    Map[# $CellContext`w& , $CellContext`c/$CellContext`m], \
$CellContext`survSpecies]]}]}, ImageSize -> 500, Axes -> True, 
                AxesLabel -> {
                 "\!\(\*StyleBox[TemplateBox[<|\"boxes\" -> \
FormBox[SubscriptBox[RowBox[{\"(\", SubscriptBox[StyleBox[\"C\", FontSlant -> \
\"Bold\"], StyleBox[\"i\", \"TI\"]], \")\"}], \"1\"], TraditionalForm], \
\"errors\" -> {}, \"input\" -> \"\\\\left(\\\\mathbf C_i\\\\right)_1\", \
\"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Bold\"]\)", 
                  "\!\(\*StyleBox[TemplateBox[<|\"boxes\" -> \
FormBox[SubscriptBox[RowBox[{\"(\", SubscriptBox[StyleBox[\"C\", FontSlant -> \
\"Bold\"], StyleBox[\"i\", \"TI\"]], \")\"}], \"2\"], TraditionalForm], \
\"errors\" -> {}, \"input\" -> \"\\\\left(\\\\mathbf C_i\\\\right)_2\", \
\"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Bold\"]\)", 
                  "\!\(\*StyleBox[TemplateBox[<|\"boxes\" -> \
FormBox[SubscriptBox[RowBox[{\"(\", SubscriptBox[StyleBox[\"C\", FontSlant -> \
\"Bold\"], StyleBox[\"i\", \"TI\"]], \")\"}], \"3\"], TraditionalForm], \
\"errors\" -> {}, \"input\" -> \"\\\\left(\\\\mathbf C_i\\\\right)_3\", \
\"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"],FontFamily->\"CMU \
Serif\",FontSize->18,FontWeight->\"Bold\"]\)"}, PlotTheme -> "Scientific", 
                Ticks -> None, Boxed -> False, AxesOrigin -> {0, 0, 0}, 
                PlotRange -> {{0, 3}, {0, 3}, {0, 3}}, ViewPoint -> 
                Dynamic[$CellContext`vp$$], ViewVertical -> 
                Dynamic[$CellContext`vv$$], ViewCenter -> {1/2, 1/2, 1/2}, 
                ViewProjection -> "Orthographic"]}, ImageSize -> 1000]]]], 
          Dynamic[
           Plot[
            Evaluate[
             Map[ReplaceAll[
               Apply[#, 
                
                Join[{$CellContext`k1$$, $CellContext`k2$$, \
$CellContext`k3$$}, {$CellContext`k1$$, $CellContext`k2$$, $CellContext`k3$$}, 
                 ConstantArray[10^(-2), 
                  Length[$CellContext`c]]]], 
               $CellContext`ExternalCRMdiffEqs3D[$CellContext`c, \
$CellContext`m, $CellContext`w]][$CellContext`t]& , 
              Map[Head, $CellContext`NN3D]]], {$CellContext`t, 0, 100}, 
            AspectRatio -> 1/3, ImageSize -> 400, Ticks -> Automatic, 
            PlotRange -> {Automatic, All}, PlotStyle -> 
            Map[Directive[#, Thick]& , {
               RGBColor[
               0.9764705882352941, 0.6274509803921569, 0.24705882352941178`], 
               
               RGBColor[
               0.4470588235294118, 0.6627450980392157, 0.5607843137254902], 
               RGBColor[0.6196078431372549, 0.35000000000000003`, 0.78], 
               RGBColor[0., 0.4117647058823529, 0.5372549019607843], 
               RGBColor[
               0.8470588235294118, 0.06666666666666667, 
                0.34901960784313724`]}], 
            AxesLabel -> {
             "\!\(\*StyleBox[\"t\",FontFamily->\"CMU \
Serif\",FontSize->14,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)", 
              "\!\(\*StyleBox[SubscriptBox[\"N\", \"i\"],FontFamily->\"CMU \
Serif\",FontSize->14,FontWeight->\"Medium\",FontSlant->\"Italic\",FontColor->\
RGBColor[0., 0., 0.]]\)"}]]}], 
       "Specifications" :> {{{$CellContext`k1$$, 0.644}, 0, 
          2}, {{$CellContext`k2$$, 1.49}, 0, 2}, {{$CellContext`k3$$, 0.643}, 
          0, 2}}, "Options" :> {}, "DefaultOptions" :> {}],
      ImageSizeCache->{1044., {402., 408.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.882138855217587*^9, 3.882138884154216*^9}, 
   3.882138931052855*^9, {3.882139006917766*^9, 3.882139036200757*^9}, 
   3.8821391034693403`*^9, 3.88213923237237*^9, 3.882139264417392*^9, 
   3.882139331682088*^9, 3.882139440322146*^9, 3.882141794338605*^9, 
   3.8821419799478197`*^9, 3.882142207224724*^9, 3.882142300359634*^9, 
   3.882142434912242*^9, 3.882142686505115*^9, 3.882142900701634*^9, 
   3.88214319448944*^9, 3.88214325949275*^9, 3.882143399845203*^9, 
   3.8821495166451073`*^9, 3.882149576649065*^9, 3.8821503677126102`*^9, 
   3.882286480078532*^9, {3.882377578918298*^9, 3.882377588850953*^9}, 
   3.882377652939699*^9, {3.8823816208397617`*^9, 3.8823816211705093`*^9}, 
   3.8823816827861443`*^9, {3.88238202392732*^9, 3.882382035139484*^9}, 
   3.889448286608533*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"9da5bf0a-a3c7-4dff-98a4-c85506a11292"]
}, Open  ]]
},
WindowSize->{1093, 891},
WindowMargins->{{157, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ccec6830-bfa4-4530-865c-27eb08f8ab0a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2127, 46, 110, "Input",ExpressionUUID->"a1c5103a-0cbb-422c-b79b-491500daf9d1",
 InitializationCell->True],
Cell[2688, 68, 2479, 64, 194, "Input",ExpressionUUID->"c5236e8f-6062-41f8-acb3-55545bb664ef",
 InitializationCell->True],
Cell[5170, 134, 1575, 43, 110, "Input",ExpressionUUID->"9638338c-02cc-4314-85d6-05c0ed4be3be",
 InitializationCell->True],
Cell[6748, 179, 2197, 62, 110, "Input",ExpressionUUID->"26bc5214-19df-4864-8e32-1b39b0386d1e",
 InitializationCell->True],
Cell[8948, 243, 174, 3, 35, "Text",ExpressionUUID->"50b88cc9-ac2c-4480-b024-cd939da4cb6e"],
Cell[CellGroupData[{
Cell[9147, 250, 2301, 57, 89, "Input",ExpressionUUID->"17fbc8f7-6e00-4711-a9a8-78d2d29740d2",
 InitializationCell->True],
Cell[11451, 309, 4390, 156, 183, "Output",ExpressionUUID->"213e4d20-8da4-4e0c-a3c8-f19b62fc84b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15878, 470, 3073, 72, 164, "Input",ExpressionUUID->"0f74b515-51c4-4425-8b92-146bfeec38c8",
 InitializationCell->True],
Cell[18954, 544, 1365, 28, 391, "Output",ExpressionUUID->"867a9d76-c977-4461-982f-740ebc62c519"]
}, Open  ]],
Cell[20334, 575, 1664, 50, 131, "Input",ExpressionUUID->"a2b65e1c-ad4a-4ad2-ab09-56c171d39568",
 InitializationCell->True],
Cell[22001, 627, 2069, 60, 131, "Input",ExpressionUUID->"0d6d2d2a-0237-4165-a26f-6429203d2313",
 InitializationCell->True],
Cell[24073, 689, 281, 6, 35, "Text",ExpressionUUID->"f6643f13-98e4-4ab0-9760-b30ac15465f4"],
Cell[24357, 697, 743, 22, 89, "Input",ExpressionUUID->"1a8c8e36-a3e3-407f-a20d-f67e8363a34d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25125, 723, 18188, 400, 1103, "Input",ExpressionUUID->"31f24bdc-de3d-42c9-ba9e-91aa2fa73037",
 InitializationCell->True],
Cell[43316, 1125, 9306, 175, 829, "Output",ExpressionUUID->"9da5bf0a-a3c7-4dff-98a4-c85506a11292"]
}, Open  ]]
}
]
*)

